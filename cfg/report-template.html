<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>{{ .Title }}</title>
  </head>
  <body style="margin:0;padding:0;background:#fafafa;">
    <!-- Wrapper -->
    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="max-width:760px;margin:0 auto;background:#fff;border-collapse:collapse;">
      <tr>
        <td style="font-family:Arial, sans-serif;color:#222;font-size:16px;padding:12px 18px;border-bottom:1px solid #eee;">
          {{ .Title }}
        </td>
      </tr>

      <!-- Summary Section -->
      <tr>
        <td align="center" style="padding:14px 8px;">
          <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">
            <tr valign="middle">
              <td align="center" style="padding:0 16px;">
                <div style="font-family:Arial, sans-serif;font-size:13px;color:#666;padding-bottom:15px;padding-top:0px;">Total Worked</div>
                <div style="font-family:Arial, sans-serif;font-size:38px;color:#111;font-weight:bold;">{{ .TotalWorked }}</div>
              </td>
              <td align="center" style="padding:0 16px;">
                <div style="font-family:Arial, sans-serif;font-size:13px;color:#666;padding-bottom:4px;">Avg Activity</div>
                {{ .ActivitySquares }}
                <div style="font-family:Arial, sans-serif;font-size:24px;color:#111;font-weight:bold;margin-top:4px;">{{ printf "%.1f%%" .AvgActivity }}</div>
              </td>
            </tr>
          </table>
        </td>
      </tr>

      <!-- Tasks in period (vertical list, centered) -->
      <tr>
        <td align="center" style="padding:4px 12px 10px 12px;">
          <div style="font-family:Arial, sans-serif;font-size:14px;color:#444;padding-bottom:6px;font-weight:bold;">Tasks in period</div>
          <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">
            {{ range .Tasks }}
            <tr>
              <td style="padding:4px 10px;font-family:Arial, sans-serif;font-size:13px;color:#333;vertical-align:middle;text-align:center;">
                <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;margin:0 auto;">
                  <tr>
                    <td style="background:{{ .ColorHex }};width:12px;height:12px;line-height:0;font-size:0;">&nbsp;</td>
                    <td style="padding-left:8px;">{{ .Name }}&nbsp;<span style="color:#666;">— {{ .Duration }}</span></td>
                  </tr>
                </table>
              </td>
            </tr>
            {{ end }}
          </table>
        </td>
      </tr>

      <!-- Time by Day (stacked per task) -->
      <tr>
        <td align="center" style="padding:15px 0 10px 0;">
          <div style="font-family:Arial, sans-serif;color:#222;font-size:14px;font-weight:bold;">Time by Day ({{ .BarRefLabel }} baseline)</div>
        </td>
      </tr>

      <!-- Centered chart wrapper -->
      <tr>
        <td align="center" style="padding:2px 0 0 0;">
          <table role="presentation" cellpadding="0" cellspacing="0" width="{{ .ChartW }}" style="border-collapse:collapse;">
            <tr>
              <td style="padding:0 20px;">
                <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;margin:0 auto;">
                  <tr valign="bottom">
                    {{ range .TimeByDayDays }}
                    <!-- Day bar -->
                    <td align="center" style="padding:0 {{ $.PadPx }}px;">
                      <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">
                        <tr><td style="background:#e0e0e0;position:relative;width:{{ $.BarWPx }}px;height:{{ .ContainerHeightPx }}px;line-height:0;font-size:0;">
                          <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;width:{{ $.BarWPx }}px;">
                            {{ if gt .TopSpacerPx 0 }}
                            <tr><td style="height:{{ .TopSpacerPx }}px;line-height:0;font-size:0;">&nbsp;</td></tr>
                            {{ end }}
                            {{ range .Segments }}
                            <tr><td style="background:{{ .ColorHex }};height:{{ .HeightPx }}px;line-height:0;font-size:0;">&nbsp;</td></tr>
                            {{ end }}
                          </table>

                          {{ if $.ShowBarLabels }}
                          <div style="position:absolute;left:0;right:0;bottom:2px;text-align:center;">
                            <span style="font-family:Arial, sans-serif;font-size:11px;color:#000;">{{ .HoursLabel }}</span>
                          </div>
                          {{ end }}
                        </td></tr>
                      </table>

                      {{ if $.WeeklyMode }}
                      <div style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding-top:6px;">{{ .DayLabel }}</div>
                      {{ else }}
                      <div style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding-top:6px;width:{{ $.PerDaySlot }}px;overflow:hidden;white-space:nowrap;line-height:1;">{{ .DayLabel }}</div>
                      {{ end }}
                    </td>
                    {{ end }}
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>

      <!-- Legend for tasks -->
      <tr>
        <td align="center" style="padding:6px 0 10px 0;">
          <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">
            <tr>
              {{ range $i, $t := .Tasks }}
              {{ if gt $i 0 }}
              <td style="width:12px;">&nbsp;</td>
              {{ end }}
              <td style="background:{{ $t.ColorHex }};width:10px;height:10px;line-height:0;font-size:0;">&nbsp;</td>
              <td style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding:0 0 0 6px;">{{ $t.Name }}</td>
              {{ end }}
            </tr>
          </table>
        </td>
      </tr>

      <!-- Activity × Time -->
      <tr>
        <td align="center" style="padding:15px 0 10px 0;">
          <div style="font-family:Arial, sans-serif;color:#222;font-size:14px;font-weight:bold;">Activity × Time ({{ .BarRefLabel }} baseline)</div>
        </td>
      </tr>

      <!-- Centered chart wrapper -->
      <tr>
        <td align="center" style="padding:2px 0 6px 0;">
          <table role="presentation" cellpadding="0" cellspacing="0" width="{{ .ChartW }}" style="border-collapse:collapse;">
            <tr>
              <td>
                <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;margin:0 auto;">
                  <tr valign="bottom">
                    {{ range .ActivityByTimeDays }}
                    <td align="center" style="padding:0 {{ $.PadPx }}px;">
                      <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">
                        <tr><td style="background:#e0e0e0;position:relative;width:{{ $.BarWPx }}px;height:{{ .ContainerHeightPx }}px;line-height:0;font-size:0;">
                          <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;width:{{ $.BarWPx }}px;">
                            <tr><td style="height:{{ .TopSpacerPx }}px;line-height:0;font-size:0;">&nbsp;</td></tr>
                            <tr><td style="background:{{ .BarColorHex }};height:{{ .BarHeightPx }}px;line-height:0;font-size:0;">&nbsp;</td></tr>
                          </table>

                          {{ if $.ShowBarLabels }}
                          <div style="position:absolute;left:0;right:0;bottom:2px;text-align:center;">
                            <span style="font-family:Arial, sans-serif;font-size:11px;color:#000;">{{ .PctLabel }}</span>
                          </div>
                          {{ end }}
                        </td></tr>
                      </table>

                      {{ if $.WeeklyMode }}
                      <div style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding-top:6px;">{{ .DayLabel }}</div>
                      {{ else }}
                      <div style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding-top:6px;width:{{ $.PerDaySlot }}px;overflow:hidden;white-space:nowrap;line-height:1;">{{ .DayLabel }}</div>
                      {{ end }}
                    </td>
                    {{ end }}
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>

      <!-- Activity × Time legend -->
      <tr>
        <td align="center" style="padding:2px 0 20px 0;">
          <table role="presentation" cellpadding="0" cellspacing="0" style="border-collapse:collapse;">
            <tr>
              <td style="background:{{ .Hex0 }};width:10px;height:10px;line-height:0;font-size:0;">&nbsp;</td>
              <td style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding:0 12px 0 6px;">0%</td>

              <td style="background:{{ .Hex50 }};width:10px;height:10px;line-height:0;font-size:0;">&nbsp;</td>
              <td style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding:0 12px 0 6px;">50%</td>

              <td style="background:{{ .Hex75 }};width:10px;height:10px;line-height:0;font-size:0;">&nbsp;</td>
              <td style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding:0 12px 0 6px;">75%</td>

              <td style="background:{{ .Hex100 }};width:10px;height:10px;line-height:0;font-size:0;">&nbsp;</td>
              <td style="font-family:Arial, sans-serif;font-size:12px;color:#555;padding:0 0 0 6px;">100%</td>
            </tr>
          </table>
        </td>
      </tr>

    </table> <!-- end white wrapper -->

	<!-- Footer OUTSIDE content area -->
    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" style="border-collapse:collapse;margin:0 auto;">
      <tr>
        <td align="center" style="padding:20px 0;">
          <div style="font-family:Arial, sans-serif;font-size:12px;color:#888;">
            Generated by Work Tracker
          </div>
        </td>
      </tr>
    </table>

  </body>
</html>
